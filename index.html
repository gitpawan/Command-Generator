<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Commands Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1a202c; /* dark gray */
        }
        ::-webkit-scrollbar-thumb {
            background: #4a5568; /* slightly lighter gray */
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #6b7280; /* even lighter gray on hover */
        }
        body {
            font-family: "Inter", sans-serif;
            margin: 0;
            overflow: hidden; /* Prevent body scrollbar, main content will scroll */
        }
        html, body, #app-container {
            height: 100%; /* Ensure full height for layout */
        }
        /* Override default select arrow for a cleaner look */
        select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='currentColor'%3e%3cpath fill-rule='evenodd' d='M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z' clip-rule='evenodd' /%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 0.7rem center;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem !important; /* Make space for the custom arrow */
        }
        .command-code {
            font-family: 'Cascadia Code', 'Fira Code', 'monospace'; /* Monospace font for code */
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100">

    <div id="app-container" class="flex flex-col md:flex-row h-screen">

        <div class="bg-gray-800 p-4 md:w-80 lg:w-96 flex-shrink-0 border-r border-gray-700 overflow-y-auto">
            <h1 class="text-2xl font-bold text-center text-teal-400 mb-6 pb-2 border-b border-gray-700">OSCP Helper</h1>

            <div class="mb-5 space-y-4">
                <div>
                    <label for="category" class="block text-gray-300 text-sm font-bold mb-1">Category:</label>
                    <select id="category" class="w-full p-2 rounded-md bg-gray-700 text-gray-100 text-sm focus:outline-none focus:ring-2 focus:ring-teal-500 transition duration-300 cursor-pointer">
                        </select>
                </div>
                <div>
                    <label for="search" class="block text-gray-300 text-sm font-bold mb-1">Search:</label>
                    <input type="text" id="search" placeholder="Search commands, OS, descriptions..."
                           class="w-full p-2 rounded-md bg-gray-700 text-gray-100 placeholder-gray-400 text-sm focus:outline-none focus:ring-2 focus:ring-teal-500 transition duration-300">
                </div>
            </div>

            <div class="mb-5 space-y-3">
                <input type="text" id="rhost_input" placeholder="RHOST (e.g., 192.168.1.100)"
                       class="w-full p-2 rounded-md bg-gray-700 text-gray-100 placeholder-gray-400 text-sm focus:outline-none focus:ring-2 focus:ring-teal-500 transition duration-300">
                <input type="text" id="lhost_input" placeholder="LHOST (e.g., 10.10.14.5)"
                       class="w-full p-2 rounded-md bg-gray-700 text-gray-100 placeholder-gray-400 text-sm focus:outline-none focus:ring-2 focus:ring-teal-500 transition duration-300">
                <input type="text" id="lport_input" placeholder="LPORT (e.g., 4444)"
                       class="w-full p-2 rounded-md bg-gray-700 text-gray-100 placeholder-gray-400 text-sm focus:outline-none focus:ring-2 focus:ring-teal-500 transition duration-300">
                <input type="text" id="user_input" placeholder="User (optional)"
                       class="w-full p-2 rounded-md bg-gray-700 text-gray-100 placeholder-gray-400 text-sm focus:outline-none focus:ring-2 focus:ring-teal-500 transition duration-300">
                <input type="password" id="pass_input" placeholder="Pass (optional)"
                       class="w-full p-2 rounded-md bg-gray-700 text-gray-100 placeholder-gray-400 text-sm focus:outline-none focus:ring-2 focus:ring-teal-500 transition duration-300">
                <input type="text" id="domain_input" placeholder="Domain (optional, e.g., example.com)"
                       class="w-full p-2 rounded-md bg-gray-700 text-gray-100 placeholder-gray-400 text-sm focus:outline-none focus:ring-2 focus:ring-teal-500 transition duration-300">
            </div>

            <div class="flex flex-wrap justify-center gap-2">
                <button id="showLinux" class="px-4 py-2 bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-semibold rounded-md shadow-md hover:from-purple-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-75 transition duration-300 text-sm flex-grow">
                    LINUX
                </button>
                <button id="showWindows" class="px-4 py-2 bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-semibold rounded-md shadow-md hover:from-purple-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-75 transition duration-300 text-sm flex-grow">
                    WINDOWS
                </button>
            </div>
        </div>

        <div class="flex-grow p-6 overflow-y-auto">
            <div id="commandsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-4">
                <p class="text-center text-gray-400 md:col-span-2 lg:col-span-2" id="loadingMessage">Loading commands...</p>
            </div>
        </div>
    </div>

    <script>
        let commands = {};
        let currentCategory = "";
        let searchTerm = "";
        let osFilter = ""; // "", "Linux", "Windows"

        // References to input fields - IDs match the HTML elements
        const rhostInput = document.getElementById('rhost_input');
        const lhostInput = document.getElementById('lhost_input');
        const lportInput = document.getElementById('lport_input');
        const userInput = document.getElementById('user_input');
        const passInput = document.getElementById('pass_input');
        const domainInput = document.getElementById('domain_input');

        const searchInput = document.getElementById('search');
        const commandsContainer = document.getElementById('commandsContainer');
        const loadingMessage = document.getElementById('loadingMessage');
        const categorySelect = document.getElementById('category');

        /**
         * Fetches the commands from the JSON file.
         */
        async function fetchCommands() {
            try {
                // IMPORTANT: Ensure 'commands.json' exists and contains the exact JSON you provided.
                const response = await fetch('commands.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                commands = await response.json();
                populateCategories();
                loadCommands(); // Display all commands initially (no OS filter applied by default)
                if(loadingMessage) loadingMessage.remove(); // Remove loading message once loaded
            } catch (error) {
                console.error('Error fetching commands:', error);
                if(commandsContainer) commandsContainer.innerHTML = `<p class="text-center text-red-400 md:col-span-2 lg:col-span-2">Failed to load commands. Please ensure 'commands.json' is in the correct directory and is valid JSON. Error: ${error.message}</p>`;
            }
        }

        /**
         * Populates the category dropdown based on fetched commands.
         */
        function populateCategories() {
            // Clear existing options, except for a potential default/placeholder one
            categorySelect.innerHTML = '<option value="">All Categories</option>'; // Add a default "All" option
            Object.keys(commands).forEach(cat => {
                const opt = document.createElement('option');
                opt.value = cat;
                // Format category name for display (e.g., "information_gathering" -> "Information Gathering")
                opt.textContent = cat.replace(/_/g, " ").replace(/\b\w/g, l => l.toUpperCase());
                categorySelect.appendChild(opt);
            });
            currentCategory = ""; // Set default to "All Categories"
        }

        /**
         * Loads and displays commands based on current filters and inputs.
         */
        function loadCommands() {
            // Get current input values
            const currentRhost = rhostInput.value;
            const currentLhost = lhostInput.value;
            const currentLport = lportInput.value;
            const currentUser = userInput.value;
            const currentPass = passInput.value;
            const currentDomain = domainInput.value;

            commandsContainer.innerHTML = ''; // Clear previous content

            // Determine which commands to display based on category filter
            let commandsToDisplay = [];
            if (currentCategory === "") { // "All Categories" selected
                Object.values(commands).forEach(categoryCommands => {
                    commandsToDisplay = commandsToDisplay.concat(categoryCommands);
                });
            } else if (commands[currentCategory]) {
                commandsToDisplay = commands[currentCategory];
            } else {
                commandsContainer.innerHTML = `<p class="text-center text-gray-400 md:col-span-2 lg:col-span-2">No commands found for the selected category.</p>`;
                return;
            }


            const filteredAndReplacedCommands = commandsToDisplay
                .filter(c =>
                    // Filter by search term in command, OS, or description
                    (c.cmd.toLowerCase().includes(searchTerm) ||
                     c.os.toLowerCase().includes(searchTerm) ||
                     (c.description && c.description.toLowerCase().includes(searchTerm))) &&
                    // Filter by OS
                    (osFilter === "" || c.os === osFilter)
                )
                .map(c => {
                    let replacedCmd = c.cmd;

                    // Dynamically replace placeholders found in the JSON.
                    // Important: These replacements only occur if the placeholder string
                    // physically exists in the 'cmd' property from your JSON.
                    replacedCmd = replacedCmd.replaceAll("{RHOST}", currentRhost || "{RHOST}");
                    replacedCmd = replacedCmd.replaceAll("{LHOST}", currentLhost || "{LHOST}");
                    replacedCmd = replacedCmd.replaceAll("{LPORT}", currentLport || "{LPORT}");
                    replacedCmd = replacedCmd.replaceAll("{USER}", currentUser || "{USER}");
                    replacedCmd = replacedCmd.replaceAll("{PASS}", currentPass || "{PASS}");
                    replacedCmd = replacedCmd.replaceAll("{DOMAIN}", currentDomain || "{DOMAIN}");

                    // Parameters without dedicated input fields in the HTML,
                    // provide sensible defaults if they are present in the JSON commands.
                    // If a placeholder (e.g., {WORDLIST_PATH}) is NOT in the JSON command strings,
                    // the replaceAll will simply do nothing for that specific string.
                    replacedCmd = replacedCmd.replaceAll("{NEW_PASS}", "NewPassword123!");
                    replacedCmd = replacedCmd.replaceAll("{FILE}", "output.txt"); // Generic file name
                    replacedCmd = replacedCmd.replaceAll("{RPORT}", "80"); // Common remote port
                    replacedCmd = replacedCmd.replaceAll("{ALT_USER}", "altuser");
                    replacedCmd = replacedCmd.replaceAll("{ALT_PASS}", "AltPassword123!");
                    replacedCmd = replacedCmd.replaceAll("{GROUP_NAME}", "Domain Admins");
                    replacedCmd = replacedCmd.replaceAll("{ADD_USER}", "NewUser");
                    replacedCmd = replacedCmd.replaceAll("{APPLICATION_NAME}", "ExampleApp"); // Default for applications
                    replacedCmd = replacedCmd.replaceAll("{PATH}", "/path/to/file_or_folder"); // Default for paths
                    replacedCmd = replacedCmd.replaceAll("{GIT_REPO_URL}", "http://example.com/.git");
                    replacedCmd = replacedCmd.replaceAll("{OUTPUT_DIRECTORY}", "/tmp/git_dump");
                    // For the chisel client's {LHOST}:, it's displayed as is as it's not a standard parameter.

                    return { ...c, cmd: replacedCmd }; // Return a new object with the replaced command
                });

            if (filteredAndReplacedCommands.length === 0) {
                commandsContainer.innerHTML = `<p class="text-center text-gray-400 md:col-span-2 lg:col-span-2">No commands found matching your criteria.</p>`;
                return;
            }

            // Grouping by OS for better readability within the filtered results
            const commandsByOs = filteredAndReplacedCommands.reduce((acc, cmd) => {
                acc[cmd.os] = acc[cmd.os] || [];
                acc[cmd.os].push(cmd);
                return acc;
            }, {});

            // Sort OS types (e.g., Windows, then Linux) for consistent display
            const sortedOsTypes = Object.keys(commandsByOs).sort((a, b) => {
                if (a === "Windows") return -1;
                if (b === "Windows") return 1;
                return a.localeCompare(b);
            });


            sortedOsTypes.forEach(osType => {
                const osSectionDiv = document.createElement('div');
                osSectionDiv.classList.add('bg-gray-800', 'p-4', 'rounded-lg', 'shadow-xl', 'transition', 'duration-300', 'ease-in-out', 'hover:shadow-2xl', 'border', 'border-gray-700', 'col-span-1');

                const osTitle = document.createElement('h3');
                osTitle.classList.add('text-xl', 'font-semibold', 'text-orange-400', 'mb-3', 'pb-1', 'border-b', 'border-gray-700');
                osTitle.textContent = `${osType} Commands`;
                osSectionDiv.appendChild(osTitle);

                const commandListDiv = document.createElement('div');
                commandListDiv.classList.add('space-y-3');

                commandsByOs[osType].forEach((c, index) => {
                    const commandCard = document.createElement('div');
                    commandCard.classList.add('bg-gray-700', 'p-3', 'rounded-md', 'shadow-md', 'flex', 'flex-col', 'md:flex-row', 'md:items-center', 'md:justify-between', 'space-y-2', 'md:space-y-0', 'transition', 'duration-200', 'ease-in-out', 'hover:bg-gray-600');

                    const commandDetails = document.createElement('div');
                    commandDetails.classList.add('flex-grow');

                    const commandCode = document.createElement('code');
                    commandCode.classList.add('command-code', 'block', 'bg-gray-900', 'text-teal-200', 'px-2', 'py-1', 'rounded-sm', 'mt-1', 'overflow-x-auto', 'whitespace-pre-wrap', 'break-words', 'text-xs');
                    commandCode.textContent = c.cmd;
                    commandCode.title = c.description; // Set description as tooltip
                    commandDetails.appendChild(commandCode);

                    commandCard.appendChild(commandDetails);

                    const copyButton = document.createElement('button');
                    const btnId = `copy-${osType}-${index}`;
                    copyButton.classList.add('ml-0', 'md:ml-3', 'px-3', 'py-1.5', 'bg-gradient-to-r', 'from-teal-600', 'to-blue-600', 'text-white', 'font-semibold', 'rounded-md', 'shadow-md', 'hover:from-teal-700', 'hover:to-blue-700', 'focus:outline-none', 'focus:ring-2', 'focus:ring-teal-500', 'focus:ring-opacity-75', 'transition', 'duration-300', 'text-sm');
                    copyButton.textContent = 'Copy';
                    copyButton.onclick = () => copyToClipboard(c.cmd);
                    commandCard.appendChild(copyButton);

                    commandListDiv.appendChild(commandCard);
                });
                osSectionDiv.appendChild(commandListDiv);
                commandsContainer.appendChild(osSectionDiv);
            });
        }

        /**
         * Copies text to the clipboard.
         * @param {string} text - The text to copy.
         */
        function copyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed';
            document.body.appendChild(textarea);
            textarea.focus();
            textarea.select();
            try {
                document.execCommand('copy');
                alertMessage('Command copied to clipboard!', 'success');
            } catch (err) {
                console.error('Failed to copy text: ', err);
                alertMessage('Failed to copy command.', 'error');
            }
            document.body.removeChild(textarea);
        }

        /**
         * Displays a custom alert message.
         * @param {string} message - The message to display.
         * @param {string} type - 'success' or 'error' for styling.
         */
        function alertMessage(message, type) {
            const alertDiv = document.createElement('div');
            alertDiv.textContent = message;
            alertDiv.classList.add('fixed', 'bottom-8', 'right-8', 'px-6', 'py-3', 'rounded-lg', 'shadow-lg', 'text-white', 'opacity-0', 'transition-opacity', 'duration-500', 'ease-out', 'z-50');

            if (type === 'success') {
                alertDiv.classList.add('bg-green-600');
            } else if (type === 'error') {
                alertDiv.classList.add('bg-red-600');
            }

            document.body.appendChild(alertDiv);

            // Fade in
            setTimeout(() => {
                alertDiv.classList.remove('opacity-0');
                alertDiv.classList.add('opacity-100');
            }, 10);

            // Fade out and remove
            setTimeout(() => {
                alertDiv.classList.remove('opacity-100');
                alertDiv.classList.add('opacity-0');
                setTimeout(() => {
                    alertDiv.remove();
                }, 500);
            }, 3000);
        }

        // Event Listeners
        categorySelect.addEventListener('change', (e) => {
            currentCategory = e.target.value;
            loadCommands();
        });

        searchInput.addEventListener('input', (e) => {
            searchTerm = e.target.value.toLowerCase();
            loadCommands();
        });

        // Event listeners for input fields
        [rhostInput, lhostInput, lportInput, userInput, passInput, domainInput].forEach(input => {
            input.addEventListener('input', loadCommands);
        });

        // Removed the 'showAll' button and its listener as requested
        document.getElementById('showLinux').addEventListener('click', () => {
            osFilter = "Linux";
            loadCommands();
        });

        document.getElementById('showWindows').addEventListener('click', () => {
            osFilter = "Windows";
            loadCommands();
        });

        // Initial fetch of commands
        document.addEventListener('DOMContentLoaded', fetchCommands);
    </script>
</body>
</html>
