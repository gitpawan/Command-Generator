<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>OSCP Command Helper</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <h1>OSCP Command Helper</h1>

  <div class="controls">
    <label for="category">Category:</label>
    <select id="category"></select>

    <label for="search">Search:</label>
    <input type="text" id="search" placeholder="Search commands...">

    <input type="text" id="local_ip" placeholder="Local IP (e.g. 10.10.14.1)">
    <input type="text" id="port" placeholder="Port (e.g. 4444)">
    <input type="text" id="username" placeholder="Username (optional)">
    <input type="password" id="password" placeholder="Password (optional)">
  </div>

  <div id="commands"></div>

  <script>
    let commands = {};
    let currentCategory = "";
    let searchTerm = "";

    // Load JSON
    fetch('commands.json')
      .then(response => response.json())
      .then(data => {
        commands = data;
        const categorySelect = document.getElementById('category');
        Object.keys(commands).forEach(cat => {
          const opt = document.createElement('option');
          opt.value = cat;
          opt.textContent = cat.replace(/_/g, " ").replace(/\b\w/g, l => l.toUpperCase());
          categorySelect.appendChild(opt);
        });
        currentCategory = categorySelect.value;
        loadCommands();
      });

    document.getElementById('category').addEventListener('change', (e) => {
      currentCategory = e.target.value;
      loadCommands();
    });

    document.getElementById('search').addEventListener('input', (e) => {
      searchTerm = e.target.value.toLowerCase();
      loadCommands();
    });

    ['local_ip', 'port', 'username', 'password'].forEach(id => {
      document.getElementById(id).addEventListener('input', loadCommands);
    });

    function loadCommands() {
      const ip = document.getElementById('local_ip').value || "{IP}";
      const port = document.getElementById('port').value || "{PORT}";
      const user = document.getElementById('username').value || "{USER}";
      const pass = document.getElementById('password').value || "{PASS}";

      const cmdDiv = document.getElementById('commands');
      cmdDiv.innerHTML = "";

      if (!commands[currentCategory]) return;

      commands[currentCategory]
        .filter(c => c.cmd.toLowerCase().includes(searchTerm) || c.os.toLowerCase().includes(searchTerm))
        .forEach(c => {
          let replaced = c.cmd
            .replaceAll("{IP}", ip)
            .replaceAll("{PORT}", port)
            .replaceAll("{USER}", user)
            .replaceAll("{PASS}", pass);
          let html = `
            <div class="command-box">
              <strong>${c.os}:</strong>
              <pre>${replaced}</pre>
              <button class="copy-btn" onclick="copyToClipboard(\`${replaced}\`)">Copy</button>
            </div>
          `;
          cmdDiv.innerHTML += html;
        });

      if (cmdDiv.innerHTML === "") {
        cmdDiv.innerHTML = "<p>No commands found.</p>";
      }
    }

    function copyToClipboard(text) {
      navigator.clipboard.writeText(text).then(() => {
        alert("Copied to clipboard!");
      });
    }
  </script>
</body>
</html>
